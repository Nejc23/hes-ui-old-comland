<app-modal-template (dismiss)="onDismiss()">
  <div modal-header>{{ getTitle() }}</div>

  <div modal-body>
    <ng-container>

      <kendo-tabstrip (tabSelect)="onTabSelect($event);" [keepTabContent]="false" style="min-height:650px;">
        <kendo-tabstrip-tab title="{{ 'COMMON.BASIC' | translate }}" [selected]="true">
          <ng-template kendoTabContent>
            <div>
              <app-input-text [form]="form" [property]="nameProperty" label="NAME"></app-input-text>

              <div class="form-row">
                <div class="col-12">
                  <app-input-text [form]="form" [property]="serialNumberProperty" label="SERIAL">
                  </app-input-text>
                </div>
              </div>

              <div class="form-row">
                <div class="col-12">
                  <app-select-input label="MANUFACTURER" [form]="form" [property]="manufacturerProperty" [selectOptions]="manufacturers"
                    [disabled]="false">
                  </app-select-input>
                </div>
              </div>

              <div class="form-row">
                <div class="col-12">
                  <app-input-text  *ngIf="isEditMu" label="PROTOCOL" [form]="form" [property]="protocolProperty"
                    [disabled]="true">
                  </app-input-text>
                </div>
              </div>

              <div class="form-row">
                <div class="col-12">
                  <app-select-input *ngIf="!isEditMu" label="TEMPLATE" [form]="form" [property]="templateProperty" [selectOptions]="templates"
                    [disabled]="false" (selectedValueChanged)="templateChanged($event)">
                  </app-select-input>
                  <app-input-text  *ngIf="isEditMu" label="TEMPLATE" [form]="form" [property]="templateStringProperty"
                    [disabled]="true">
                  </app-input-text>
                </div>
              </div>

              <div class="form-row">
                <div class="col-12">
                  <app-select-input label="CONNECTION-TYPE" [form]="form" [property]="connectionTypeProperty" [selectOptions]="connectionTypes"
                    [disabled]="false" (selectedValueChanged)="onConnectionTypeChanged($event)">
                  </app-select-input>
                </div>
              </div>

              <div class="form-row" *ngIf="isConnectionTypeIp">
                <div class="col-6">
                  <app-input-text dis [form]="form" [property]="ipProperty" label="IP"></app-input-text>
                </div>
                <div class="col-3">
                  <app-input-numeric label="PORT" [form]="form" [property]="portProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                    [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                </div>
              </div>

              <div class="form-row" *ngIf="isNewOrProtocolDlms">
                <div class="col-12">
                  <app-input-radio label="COMMUNICATION-TYPE" [form]="form" [property]="communicationTypeProperty"
                    name="fileTypeRadio" [options]="communicationTypes" box="true" [hideLabelSmall]="true" [hideCheckbox]="true" (selectionChanged)="communicationTypeChanged($event, !isEditMu)" >
                  </app-input-radio>
                </div>
              </div>

              <div class="form-row" *ngIf="isHdlcSelected">
                <div class="col-12">

                  <div class="d-flex justify-content-between gray-line gray-line-top py-3 mt-4">
                    <div class="modal-checkbox-label">
                      <div class="text-normal-bold">{{ 'PLC-METER.SHORT-NAMES-REFERENCING' | translate }}</div>
                      <div class="tiny-text gray-color-dark pt-1">{{ 'PLC-METER.ADDRESS-BY-SHORT-ADDRESSES' | translate }}</div>
                    </div>
                    <div>
                      <kendo-switch class="mt-2" [(ngModel)]="shortNameSelected"
                                    (valueChange)="onShortNameChanges($event)"></kendo-switch>
                    </div>
                  </div>

                </div>
              </div>

            </div>


          </ng-template>
        </kendo-tabstrip-tab>
        <kendo-tabstrip-tab title="{{ 'FORM.JOBS' | translate }}" *ngIf="!isEditMu">
          <ng-template kendoTabContent>
            <ng-template *ngTemplateOutlet="noTemplateSelected"></ng-template>

            <div class="form-row" *ngIf="isTemplateSelected">
              <div class="col-12 p-0">
                <div>
                  <app-jobs-select [jobTypes]="[2]" [height]="'530px'"></app-jobs-select>
                </div>
              </div>
            </div>

          </ng-template>
        </kendo-tabstrip-tab>
        <kendo-tabstrip-tab title="{{ 'COMMON.COMMUNICATION' | translate }}" *ngIf="isNewOrProtocolDlms">
          <ng-template kendoTabContent>
            <ng-template *ngTemplateOutlet="noTemplateSelected"></ng-template>

              <div *ngIf="isTemplateSelected && communicationTypeSelected" class="pt-3">
                <!--<div class="form-row" *ngIf="isHdlcSelected">
                  <div class="col-6">
                    <app-input-switch [form]="form" [property]="isShortNameProperty" i18n-label label="Shortname">
                    </app-input-switch>
                  </div>
                </div>-->

                <div>
                  <label class="label-primary">{{ 'PLC-METER.MANAGEMENT-ASSOCIATION' | translate }}</label>
                </div>
                <div class="border px-2 py-2">
                  <div class="form-row" *ngIf="isWrapperSelected">
                    <div class="col-6">
                      <app-input-numeric label="CLIENT" [form]="form" [property]="wrapperClientAddressProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                      [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                    </div>
                    <div class="col-6">
                      <app-input-numeric label="SERVER" [form]="form" [property]="wrapperServerAddressProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                      [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                    </div>
                  </div>
                  <div *ngIf="isHdlcSelected">
                    <div class="form-row">
                      <div class="col-6">
                        <app-input-numeric label="CLIENT-LOW" [form]="form" [property]="clientLowProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                      <div class="col-6">
                        <app-input-numeric label="SERVER-LOW" [form]="form" [property]="serverLowProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                    </div>
                    <div class="form-row">
                      <div class="col-6">
                        <app-input-numeric label="CLIENT-HIGH" [form]="form" [property]="clientHighProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                      <div class="col-6">
                        <app-input-numeric label="SERVER-HIGH" [form]="form" [property]="serverHighProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="pt-3">
                  <label class="label-primary">{{ 'PLC-METER.PUBLIC-ASSOCIATION' | translate }}</label>
                </div>
                <div class="border px-2 py-2">
                  <div *ngIf="isWrapperSelected">
                    <div class="form-row">
                      <div class="col-6">
                        <app-input-numeric label="CLIENT" [form]="form" [property]="wrapperPublicClientAddressProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                      <div class="col-6">
                        <app-input-numeric label="SERVER" [form]="form" [property]="wrapperPublicServerAddressProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                    </div>
                  </div>
                  <div *ngIf="isHdlcSelected">
                    <div class="form-row">
                      <div class="col-6">
                        <app-input-numeric label="CLIENT-LOW" [form]="form" [property]="publicClientLowProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                      <div class="col-6">
                        <app-input-numeric label="SERVER-LOW" [form]="form" [property]="publicServerLowProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                    </div>
                    <div class="form-row">
                      <div class="col-6">
                        <app-input-numeric label="CLIENT-HIGH" [form]="form" [property]="publicClientHighProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                      <div class="col-6">
                        <app-input-numeric label="SERVER-HIGH" [form]="form" [property]="publicServerHighProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                        [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="isWrapperSelected">
                  <div class="form-row pt-3">
                    <div class="col-6">
                      <app-input-switch [form]="form" [property]="isGatewayProperty" label="GATEWAY" (valueChanged)="gatewayChanged($event)">
                      </app-input-switch>
                    </div>
                  </div>
                  <div class="border px-2" *ngIf="isGatewayEnabled">
                    <app-input-numeric label="PHYSICAL-ADDRESS" [form]="form" [property]="wrapperPhysicalAddressProperty" [showSpinners]="false" [decimals]="0" [min]="0" [max]="65535"
                          [format]="'#'" [step]="1" [isReadOnly]="false" [allowShowError]="true" [noFlex]="true"></app-input-numeric>
                  </div>
                </div>
              </div>
          </ng-template>
        </kendo-tabstrip-tab>
        <kendo-tabstrip-tab title="{{ 'COMMON.ADVANCED' | translate }}" *ngIf="isNewOrProtocolDlms">
          <ng-template kendoTabContent>
            <ng-template [ngTemplateOutlet]="noTemplateSelected"></ng-template>
            <div *ngIf="isTemplateSelected">
              <div class="form-row pt-2">
                <div class="col-6">
                  <app-input-switch [form]="form" [property]="advancedStartWithReleaseProperty" label="START-WITH-RELEASE">
                  </app-input-switch>
                </div>
              </div>
              <div class="form-row">
                <div class="col-8">
                  <app-input-switch [form]="form" [property]="advancedLdnAsSystitleProperty" label="USE-LDN-AS-SYSTITLE">
                  </app-input-switch>
                </div>
              </div>
              <div class="form-row">
                <div class="col-6">
                  <app-select-input label="AUTHENTICATION-TYPE" [form]="form" [property]="authenticationTypeProperty" [selectOptions]="authenticationTypes"
                    [disabled]="false">
                  </app-select-input>
                </div>
              </div>
            </div>
          </ng-template>
        </kendo-tabstrip-tab>
        <!-- <kendo-tabstrip-tab [title]="tabTitleCustomProperties">
          <ng-template kendoTabContent>
            Custom properties
          </ng-template>
        </kendo-tabstrip-tab> -->
      </kendo-tabstrip>
    </ng-container>
  </div>

  <div modal-footer>
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-link" (click)="cancel()">{{ 'BUTTON.CANCEL' | translate }}</button>
      <div dropdown class="btn-group dropdown">
        <button type="submit" class="btn btn-primary" (click)="add()" *ngIf="!isEditMu">{{ 'BUTTON.ADD' | translate }}</button>
        <button type="submit" class="btn btn-primary" (click)="update()" *ngIf="isEditMu">{{ 'BUTTON.UPDATE' | translate }}</button>
        <!-- <button dropdownToggle type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false" [ngbTooltip]="tipMoreSave">
        </button> -->
        <!-- <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
          <a class="dropdown-item" (click)="save(true)" i18n>Save and Add another</a>
        </div> -->
      </div>
    </div>
  </div>
</app-modal-template>

<ng-template #noTemplateSelected >
  <div class="card text-center border-0 mt-5" *ngIf="!isTemplateSelected">
    <div class="card-header border-0 bg-transparent">
      <i class="far fa-exclamation-triangle display-2 text-light font-weight-bold"></i>
    </div>
    <div class="card-body pt-0">
      <div class="small-title pb-2">{{ 'PLC-METER.TEMPLATE-NOT-SELECTED' | translate }}</div>
      <div class="text-secondary">{{ 'PLC-METER.SELECT-TEMPLATE' | translate }}</div>
      <div class="mt-3 mb-5 mx-5 px-5">
        <app-select-input [form]="form" [property]="templateProperty" [selectOptions]="templates"
          [disabled]="false" (selectedValueChanged)="templateChanged($event)">
        </app-select-input>
      </div>
    </div>
  </div>
</ng-template>

