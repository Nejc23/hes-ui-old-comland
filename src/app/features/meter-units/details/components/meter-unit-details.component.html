<div class="row">
  <div class="col-4 ng-star-inserted">

    <div class="mb-3">
      <button class="btn btn-primary" [disabled]="!data" (click)="editMeterUnit()" appHideIfPermissionUnauthorized [permission]="permissionMuManage">
     <span>{{ 'BUTTON.EDIT' | translate }}</span>
      </button>
      <div class="btn-group pe-2" appHideIfPermissionUnauthorized [permission]="permissionMuManage">
        <button class="btn btn-secondary" type="button" (click)="onDelete()"><span>{{ 'BUTTON.DELETE' | translate }}</span></button>
      </div>
      <div dropdown class="btn-group" appHideIfAllPermissionsUnauthorized [permissions]="[
        permissionManageJobs,
        permissionAssignTemplates,
        permissionFwUpgrade,
        permissionFwUpgrade,
        permissionDisconnectorConnect,
        permissionDisconnectorDisconnect,
        permissionDisconnectorGetState,
        permissionDisconnectorSetMode,
        permissionCiiActivate,
        permissionCiiDeactivate,
        permissionCiiState,
        permissionRelaysConnect,
        permissionRelaysDisconnect,
        permissionRelaysState,
        permissionRelaysSetMode
      ]">
        <button dropdownToggle class="btn btn-secondary dropdown-toggle" type="button" id="operationsDropDown"
          data-bs-toggle="dropdown"><span>{{ 'OPERATION.OPERATIONS' | translate }}</span></button>
        <div *dropdownMenu (click)="$event.stopPropagation();" class="dropdown-menu">
          <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionManageJobs">
            <div class="dropdown-submenu">
                <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'PLC-METER.JOB' | translate }}</span></a>
                <div class="dropdown-menu">
                  <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionManageJobs" (click)="onScheduleReadJobs()">
                    <a href="javascript:void(0)" ><span>{{ 'PLC-METER.CREATE-NEW' | translate }}</span></a>
                  </div>
                  <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionManageJobs" (click)="onJobsAssignExisting()">
                    <a href="javascript:void(0)" ><span>{{ 'PLC-METER.ASSIGN-EXISTING' | translate }}</span></a>
                  </div>
                </div>
            </div>
          </div>
          <div appHideIfPermissionUnauthorized [permission]="permissionAssignTemplates">
            <a href="javascript:void(0)" class="dropdown-item custom-hover-display"
            (click)="onJobsTemplates()"><span>{{ 'PLC-METER.TEMPLATES' | translate }}</span></a>
          </div>

          <div class="dropdown-divider" appHideDividerIfPermissionsUnauthorized [permissionsAbove]="[permissionManageJobs, permissionAssignTemplates]" [permissionsBelow]="[permissionFwUpgrade]"></div>

          <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionFwUpgrade" >
            <div class="dropdown-submenu">
                  <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'PLC-METER.FW-UPGRADE-TITLE' | translate }}</span></a>
                <div class="dropdown-menu">
                  <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionFwUpgrade" (click)="onUpgrade()">
                    <a href="javascript:void(0)"><span>{{ 'PLC-METER.UPLOAD-IMAGE' | translate }}</span></a>
                  </div>
                  <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionFwUpgrade" (click)="onActivateUpgrade()">
                    <a href="javascript:void(0)"><span>{{ 'PLC-METER.ACTIVATE-IMAGE' | translate }}</span></a>
                  </div>
                </div>
            </div>
          </div>

          <div class="dropdown-divider" appHideDividerIfPermissionsUnauthorized
            [permissionsAbove]="[permissionFwUpgrade]"
            [permissionsBelow]="[permissionDisconnectorConnect,
                                 permissionDisconnectorDisconnect,
                                 permissionDisconnectorGetState,
                                 permissionDisconnectorSetMode,
                                 permissionCiiActivate,
                                 permissionCiiDeactivate,
                                 permissionCiiState,
                                 permissionRelaysConnect,
                                 permissionRelaysDisconnect,
                                 permissionRelaysState,
                                 permissionRelaysSetMode]"></div>
          <div class="dropdown-item" appHideIfAllPermissionsUnauthorized [permissions]="[permissionDisconnectorConnect, permissionDisconnectorDisconnect, permissionDisconnectorGetState, permissionDisconnectorSetMode]" >
            <div class="dropdown-submenu">
              <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'PLC-METER.BREAKER.BREAKER' | translate }}</span></a>
              <div class="dropdown-menu">
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionDisconnectorConnect" (click)="onConnect()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.CONNECT' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionDisconnectorDisconnect" (click)="onDisconnect()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.DISCONNECT' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionDisconnectorGetState" (click)="onDisconnectorStatus()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.STATE' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionDisconnectorSetMode" (click)="onDisconnectorMode()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.MODE' | translate }}</span></a>
                </div>
              </div>
            </div>
          </div>

          <div class="dropdown-item" appHideIfAllPermissionsUnauthorized [permissions]="[permissionCiiActivate, permissionCiiDeactivate, permissionCiiState]">
            <div class="dropdown-submenu">
              <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'COMMON.CII' | translate }}</span></a>
              <div class="dropdown-menu">
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionCiiActivate" (click)="onCiiActivate()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.ACTIVATE' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionCiiDeactivate"  (click)="onCiiDeactivate()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.DEACTIVATE' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionCiiState" (click)="onCiiState()">
                  <a href="javascript:void(0)"><span>{{ 'COMMON.STATE' | translate }}</span></a>
                </div>
              </div>
            </div>
          </div>

          <div class="dropdown-item" appHideIfAllPermissionsUnauthorized [permissions]="[permissionRelaysConnect, permissionRelaysDisconnect, permissionRelaysState, permissionRelaysSetMode]">
            <div class="dropdown-submenu">
              <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'COMMON.RELAYS' | translate }}</span></a>
            <div class="dropdown-menu">
              <div class="dropdown-item" (click)="onRelaysConnect()" appHideIfPermissionUnauthorized [permission]="permissionRelaysConnect">
                <a href="javascript:void(0)"><span>{{ 'COMMON.CONNECT' | translate }}</span></a>
              </div>
              <div class="dropdown-item" (click)="onRelaysDisconnect()" appHideIfPermissionUnauthorized [permission]="permissionRelaysDisconnect">
                <a href="javascript:void(0)"><span>{{ 'COMMON.DISCONNECT' | translate }}</span></a>
              </div>
              <div class="dropdown-item" (click)="onRelaysState()" appHideIfPermissionUnauthorized [permission]="permissionRelaysState">
                <a href="javascript:void(0)"><span>{{ 'COMMON.STATE' | translate }}</span></a>
              </div>
              <div class="dropdown-item" (click)="onRelaysSetMode()" appHideIfPermissionUnauthorized [permission]="permissionRelaysSetMode">
                <a href="javascript:void(0)" ><span>{{ 'COMMON.MODE' | translate }}</span></a>
              </div>
            </div>
          </div>
         </div>

         <div class="dropdown-divider" appHideDividerIfPermissionsUnauthorized
            [permissionsAbove]="[permissionDisconnectorConnect,
                                 permissionDisconnectorDisconnect,
                                 permissionDisconnectorGetState,
                                 permissionDisconnectorSetMode,
                                 permissionCiiActivate,
                                 permissionCiiDeactivate,
                                 permissionCiiState,
                                 permissionRelaysConnect,
                                 permissionRelaysDisconnect,
                                 permissionRelaysState,
                                 permissionRelaysSetMode]"
            [permissionsBelow]="[permissionTouUpload]"></div>

          <div appHideIfPermissionUnauthorized [permission]="permissionTouUpload" href="javascript:void(0)">
            <a class="dropdown-item custom-hover-display"
              (click)="onTou()"><span>{{ 'PLC-METER.TOU-UPLOAD' | translate }}</span></a>
          </div>
          <div class="dropdown-divider" appHideDividerIfPermissionsUnauthorized
            [permissionsAbove]="[permissionTouUpload]"
            [permissionsBelow]="[permissionSetLimiter,
                                permissionSetMonitor,
                                permissionClearFF,
                                permissionSetDisplay,
                                permissionClearAlarms]"></div>

          <div appHideIfPermissionUnauthorized [permission]="permissionSyncTime">
            <a href="javascript:void(0)" class="dropdown-item custom-hover-display"
               (click)="onSyncTime()"><span>{{ 'COMMON.SYNCHRONIZE-TIME' | translate }}</span></a>
          </div>

          <div class="dropdown-item" appHideIfAllPermissionsUnauthorized [permissions]="[permissionSetLimiter, permissionReadMeter]">
            <div class="dropdown-submenu">
              <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'COMMON.LIMITER' | translate }}</span></a>
              <div class="dropdown-menu">
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionSetLimiter" (click)="onSetLimiter()">
                  <a href="javascript:void(0)"><span>{{ 'PLC-METER.SET-THRESHOLDS' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionReadMeter" (click)="onReadLimiterThreshold()">
                  <a href="javascript:void(0)"><span>{{ 'PLC-METER.READ-THRESHOLDS' | translate }}</span></a>
                </div>
              </div>
            </div>
          </div>
          <div class="dropdown-item" appHideIfAllPermissionsUnauthorized [permissions]="[permissionSetMonitor, permissionReadMeter]">
            <div class="dropdown-submenu">
              <a dropdownToggle class="dropdown-toggle disabled" href="javascript:void(0)" data-bs-toggle="dropdown"><span>{{ 'COMMON.MONITOR' | translate }}</span></a>
              <div class="dropdown-menu">
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionSetMonitor" (click)="onSetMonitor()">
                  <a href="javascript:void(0)"><span>{{ 'PLC-METER.SET-THRESHOLDS' | translate }}</span></a>
                </div>
                <div class="dropdown-item" appHideIfPermissionUnauthorized [permission]="permissionReadMeter" (click)="onReadMonitorThreshold()">
                  <a href="javascript:void(0)"><span>{{ 'PLC-METER.READ-THRESHOLDS' | translate }}</span></a>
                </div>
              </div>
            </div>
          </div>
          <div appHideIfPermissionUnauthorized [permission]="permissionClearFF">
            <a href="javascript:void(0)" class="dropdown-item custom-hover-display"
              (click)="onClearFF()"><span>{{ 'PLC-METER.CLEAR-FF' | translate }}</span></a>
          </div>
          <div appHideIfPermissionUnauthorized [permission]="permissionSetDisplay">
            <a href="javascript:void(0)" class="dropdown-item custom-hover-display"
              (click)="onSetDisplaySettings()"><span>{{ 'PLC-METER.SET-DISPLAY-SETTINGS-TITLE' | translate }}</span></a>
          </div>
          <div appHideIfPermissionUnauthorized [permission]="permissionClearAlarms">
            <a href="javascript:void(0)" class="dropdown-item custom-hover-display gray-light-line"
              (click)="onClearAlarms()"><span>{{ 'PLC-METER.CLEAR-ALARMS' | translate }}</span></a>
          </div>
          <div [permission]="permissionReadMeter" appHideIfPermissionUnauthorized>
            <a (click)="onReadMeter()" class="dropdown-item custom-hover-display item-padding"
               href="javascript:void(0)">
              <span>{{ 'COMMON.READ-METER' | translate }}</span></a>
          </div>
        </div>
      </div>
    </div>

    <div class="mb-3" *ngIf="data">
      <div class="alert alert-danger alert-dismissible fade show" role="alert" *ngIf="saveError">
        <strong><span>{{ 'PLC-METER.ERROR-SAVING-MU' | translate }}</span></strong> <br /> {{saveError}}
      </div>

      <div class="mb-3">
        <div class="form-row mb-4">
          <div class="col">
            <div><label>{{ 'FORM.NAME' | translate }}</label></div>
            <div><span>{{ data.name }}</span></div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label>{{ 'FORM.SERIAL-NUMBER' | translate }}</label></div>
            <div><span>{{ data.serialNumber }}</span></div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label>{{ 'FORM.TEMPLATE' | translate }}</label></div>
            <div><span>{{ data.templateName }}</span></div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label>{{ 'FORM.PROTOCOL' | translate }}</label></div>
            <div><span>{{ data.protocol }}</span></div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label>{{ 'FORM.MANUFACTURER' | translate }}</label></div>
            <div><span>{{ data.manufacturer }}</span></div>
          </div>
        </div>
        <div class="form-row mb-4" *ngIf="!isPlcDevice">
          <div class="col">
            <div><label>{{ 'FORM.IP' | translate }}</label></div>
            <div><span>{{data.ip}}</span></div>
          </div>
        </div>
        <div class="form-row mb-4" *ngIf="!isPlcDevice">
          <div class="col">
            <div><label>{{ 'FORM.PORT' | translate }}</label></div>
            <div><span>{{data.port}}</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
