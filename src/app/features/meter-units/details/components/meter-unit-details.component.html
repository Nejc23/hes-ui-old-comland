<div class="row">
  <div class="col-4 ng-star-inserted">
    <div class="form-group">
      <button
        (click)="editMeterUnit()"
        [disabled]="!data"
        [permission]="permissionMuManage"
        appHideIfPermissionUnauthorized
        class="btn btn-primary"
      >
        <span i18n>Edit</span>
      </button>
      <div [permission]="permissionMuManage" appHideIfPermissionUnauthorized class="btn-group pr-2">
        <button (click)="onDelete()" class="btn btn-secondary" type="button"><span i18n>Delete</span></button>
      </div>
      <div
        [permissions]="[
          permissionManageJobs,
          permissionAssignTemplates,
          permissionFwUpgrade,
          permissionFwUpgrade,
          permissionDisconnectorConnect,
          permissionDisconnectorDisconnect,
          permissionDisconnectorGetState,
          permissionDisconnectorSetMode,
          permissionCiiActivate,
          permissionCiiDeactivate,
          permissionCiiState,
          permissionRelaysConnect,
          permissionRelaysDisconnect,
          permissionRelaysState,
          permissionRelaysSetMode
        ]"
        appHideIfAllPermissionsUnauthorized
        class="btn-group"
        dropdown
      >
        <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" dropdownToggle id="operationsDropDown" type="button">
          <span i18n>Operations</span>
        </button>
        <div (click)="$event.stopPropagation()" *dropdownMenu class="dropdown-menu">
          <div [permission]="permissionManageJobs" appHideIfPermissionUnauthorized class="dropdown-item">
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"><span i18n>Job</span></a>
              <div class="dropdown-menu">
                <div
                  (click)="onScheduleReadJobs()"
                  [permission]="permissionManageJobs"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Create new</span></a>
                </div>
                <div
                  (click)="onJobsAssignExisting()"
                  [permission]="permissionManageJobs"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Assign existing</span></a>
                </div>
              </div>
            </div>
          </div>
          <div [permission]="permissionAssignTemplates" appHideIfPermissionUnauthorized>
            <a (click)="onJobsTemplates()" class="dropdown-item custom-hover-display" href="javascript:void(0)"
              ><span i18n>Templates</span></a
            >
          </div>

          <div
            [permissionsAbove]="[permissionManageJobs, permissionAssignTemplates]"
            [permissionsBelow]="[permissionFwUpgrade]"
            appHideDividerIfPermissionsUnauthorized
            class="dropdown-divider"
          ></div>

          <div [permission]="permissionFwUpgrade" appHideIfPermissionUnauthorized class="dropdown-item">
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"
                ><span i18n>FW upgrade</span></a
              >
              <div class="dropdown-menu">
                <div (click)="onUpgrade()" [permission]="permissionFwUpgrade" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>Upload image</span></a>
                </div>
                <div (click)="onActivateUpgrade()" [permission]="permissionFwUpgrade" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>Activate image</span></a>
                </div>
              </div>
            </div>
          </div>

          <div
            [permissionsAbove]="[permissionFwUpgrade]"
            [permissionsBelow]="[
              permissionDisconnectorConnect,
              permissionDisconnectorDisconnect,
              permissionDisconnectorGetState,
              permissionDisconnectorSetMode,
              permissionCiiActivate,
              permissionCiiDeactivate,
              permissionCiiState,
              permissionRelaysConnect,
              permissionRelaysDisconnect,
              permissionRelaysState,
              permissionRelaysSetMode
            ]"
            appHideDividerIfPermissionsUnauthorized
            class="dropdown-divider"
          ></div>
          <div
            [permissions]="[
              permissionDisconnectorConnect,
              permissionDisconnectorDisconnect,
              permissionDisconnectorGetState,
              permissionDisconnectorSetMode
            ]"
            appHideIfAllPermissionsUnauthorized
            class="dropdown-item"
          >
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"
                ><span i18n>Breaker</span></a
              >
              <div class="dropdown-menu">
                <div
                  (click)="onConnect()"
                  [permission]="permissionDisconnectorConnect"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Connect</span></a>
                </div>
                <div
                  (click)="onDisconnect()"
                  [permission]="permissionDisconnectorDisconnect"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Disconnect</span></a>
                </div>
                <div
                  (click)="onDisconnectorStatus()"
                  [permission]="permissionDisconnectorGetState"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>State</span></a>
                </div>
                <div
                  (click)="onDisconnectorMode()"
                  [permission]="permissionDisconnectorSetMode"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Mode</span></a>
                </div>
              </div>
            </div>
          </div>

          <div
            [permissions]="[permissionCiiActivate, permissionCiiDeactivate, permissionCiiState]"
            appHideIfAllPermissionsUnauthorized
            class="dropdown-item"
          >
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"><span i18n>CII</span></a>
              <div class="dropdown-menu">
                <div (click)="onCiiActivate()" [permission]="permissionCiiActivate" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>Activate</span></a>
                </div>
                <div
                  (click)="onCiiDeactivate()"
                  [permission]="permissionCiiDeactivate"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Deactivate</span></a>
                </div>
                <div (click)="onCiiState()" [permission]="permissionCiiState" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>State</span></a>
                </div>
              </div>
            </div>
          </div>

          <div
            [permissions]="[permissionRelaysConnect, permissionRelaysDisconnect, permissionRelaysState, permissionRelaysSetMode]"
            appHideIfAllPermissionsUnauthorized
            class="dropdown-item"
          >
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"
                ><span i18n>Relays</span></a
              >
              <div class="dropdown-menu">
                <div
                  (click)="onRelaysConnect()"
                  [permission]="permissionRelaysConnect"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Connect</span></a>
                </div>
                <div
                  (click)="onRelaysDisconnect()"
                  [permission]="permissionRelaysDisconnect"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Disconnect</span></a>
                </div>
                <div (click)="onRelaysState()" [permission]="permissionRelaysState" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>State</span></a>
                </div>
                <div
                  (click)="onRelaysSetMode()"
                  [permission]="permissionRelaysSetMode"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Mode</span></a>
                </div>
              </div>
            </div>
          </div>

          <div
            [permissionsAbove]="[
              permissionDisconnectorConnect,
              permissionDisconnectorDisconnect,
              permissionDisconnectorGetState,
              permissionDisconnectorSetMode,
              permissionCiiActivate,
              permissionCiiDeactivate,
              permissionCiiState,
              permissionRelaysConnect,
              permissionRelaysDisconnect,
              permissionRelaysState,
              permissionRelaysSetMode
            ]"
            [permissionsBelow]="[permissionTouUpload]"
            appHideDividerIfPermissionsUnauthorized
            class="dropdown-divider"
          ></div>

          <div [permission]="permissionTouUpload" appHideIfPermissionUnauthorized href="javascript:void(0)">
            <a (click)="onTou()" class="dropdown-item custom-hover-display"><span i18n>TOU Upload</span></a>
          </div>
          <div
            [permissionsAbove]="[permissionTouUpload]"
            [permissionsBelow]="[
              permissionSetLimiter,
              permissionSetMonitor,
              permissionClearFF,
              permissionSetDisplay,
              permissionClearAlarms
            ]"
            appHideDividerIfPermissionsUnauthorized
            class="dropdown-divider"
          ></div>

          <div [permission]="permissionSyncTime" appHideIfPermissionUnauthorized>
            <a (click)="onSyncTime()" class="dropdown-item custom-hover-display" href="javascript:void(0)"
              ><span i18n>Synchronize time</span></a
            >
          </div>

          <div [permissions]="[permissionSetLimiter, permissionReadMeter]" appHideIfAllPermissionsUnauthorized class="dropdown-item">
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"
                ><span i18n>Limiter</span></a
              >
              <div class="dropdown-menu">
                <div (click)="onSetLimiter()" [permission]="permissionSetLimiter" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>Set thresholds</span></a>
                </div>
                <div
                  (click)="onReadLimiterThreshold()"
                  [permission]="permissionReadMeter"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Read thresholds</span></a>
                </div>
              </div>
            </div>
          </div>
          <div [permissions]="[permissionSetMonitor, permissionReadMeter]" appHideIfAllPermissionsUnauthorized class="dropdown-item">
            <div class="dropdown-submenu">
              <a class="dropdown-toggle disabled" data-toggle="dropdown" dropdownToggle href="javascript:void(0)"
                ><span i18n>Monitor</span></a
              >
              <div class="dropdown-menu">
                <div (click)="onSetMonitor()" [permission]="permissionSetMonitor" appHideIfPermissionUnauthorized class="dropdown-item">
                  <a href="javascript:void(0)"><span i18n>Set thresholds</span></a>
                </div>
                <div
                  (click)="onReadMonitorThreshold()"
                  [permission]="permissionReadMeter"
                  appHideIfPermissionUnauthorized
                  class="dropdown-item"
                >
                  <a href="javascript:void(0)"><span i18n>Read thresholds</span></a>
                </div>
              </div>
            </div>
          </div>
          <div [permission]="permissionClearFF" appHideIfPermissionUnauthorized>
            <a (click)="onClearFF()" class="dropdown-item custom-hover-display" href="javascript:void(0)"><span i18n>Clear FF</span></a>
          </div>
          <div [permission]="permissionSetDisplay" appHideIfPermissionUnauthorized>
            <a (click)="onSetDisplaySettings()" class="dropdown-item custom-hover-display" href="javascript:void(0)"
              ><span i18n>Set display settings</span></a
            >
          </div>
          <div [permission]="permissionClearAlarms" appHideIfPermissionUnauthorized>
            <a (click)="onClearAlarms()" class="dropdown-item custom-hover-display gray-light-line" href="javascript:void(0)"
              ><span i18n>Clear Alarms</span></a
            >
          </div>

          <div [permission]="permissionClearAlarms" appHideIfPermissionUnauthorized>
            <a (click)="onReadMeter()" class="dropdown-item custom-hover-display item-padding" href="javascript:void(0)"
              ><span>Read meter</span></a
            >
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="data" class="form-group">
      <div *ngIf="saveError" class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong><span i18n>Error saving Meter Unit!</span></strong> <br />
        {{ saveError }}
      </div>

      <div class="form-group">
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Name</label></div>
            <div>
              <span>{{ data.name }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Serial number</label></div>
            <div>
              <span>{{ data.serialNumber }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Template</label></div>
            <div>
              <span>{{ data.templateName }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Protocol</label></div>
            <div>
              <span>{{ data.protocol }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Manufacturer</label></div>
            <div>
              <span>{{ data.manufacturer }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>IP</label></div>
            <div>
              <span>{{ data.ip }}</span>
            </div>
          </div>
        </div>
        <div class="form-row mb-4">
          <div class="col">
            <div><label i18n>Port</label></div>
            <div>
              <span>{{ data.port }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
